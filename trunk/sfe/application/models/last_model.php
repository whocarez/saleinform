<?php/* * Last Model */class Last_model extends Model{	private $ciObject;	public function __construct(){		parent::Model();		$this->ciObject = &get_instance();	}
	public function GetLastNews(){		$this->db->select("*, DATE_FORMAT(newdate, '%d-%m-%Y | %H:%i') as newDATE, newdate as forORDER", False);		$this->db->from('_news');		$this->db->orderby('rid DESC');		$this->db->limit('5');		$query = $this->db->get();		if($query->num_rows()) return $query->result_array();		return false;	}
	public function getLastCluopinions(){		$countryRID = $this->ciObject->settings_module->getSetting('_COUNTRY_RID_');		$this->db->select("_cluopinions.*, 							DATE_FORMAT(_cluopinions.createDT, '%d/%m/%Y') as opinionDATE,							(select sum(_clopinionsrates.rate) from _clopinionsrates where _clopinionsrates._cluopinions_rid = _cluopinions.rid) as rate,							_members.login,							_countries.cod,							_countries.name,							_cities.name,							_clients.name,							_clients.rid,							_clients.slug,							_clientslogos.name as logo_name,							_clientslogos.image as logo_image,							_clientslogos.rid as logo_rid", False);		$this->db->from('_cluopinions');		$this->db->join('_clients', '_clients.rid = _cluopinions._clients_rid');		$this->db->join('_clientslogos', '_clients.rid = _clientslogos._clients_rid', 'LEFT');		$this->db->join('_members', '_members.rid = _cluopinions._members_rid');		$this->db->join('_cities', '_cities.rid = _clients._cities_rid');		$this->db->join('_regions', '_regions.rid = _cities._regions_rid');		$this->db->join('_countries', '_countries.rid = _regions._countries_rid');		$this->db->where(array('_clients.active'=>'1', '_countries.rid'=>$countryRID));		$this->db->orderby('_cluopinions.rid DESC');		$this->db->groupby('_cluopinions.rid');		$this->db->limit('5');		$query = $this->db->get();		return $query->num_rows()?$query->result():array();	}	public function getLastWuopinions(){		$this->db->select("_waresuopinions.*, 							DATE_FORMAT(_waresuopinions.createDT, '%d-%m-%Y | %H:%i') as opinionDATE,							_members.display_name,							_wares._categories_rid,							_wares._brands_rid,							_wares.slug,							_wares.name as wareNAME");		$this->db->from('_waresuopinions');		$this->db->join('_wares', '_wares.rid = _waresuopinions._wares_rid');		$this->db->join('_pritems', '_wares.rid = _pritems._wares_rid');		$this->db->join('_brands', '_brands.rid = _wares._brands_rid');		$this->db->join('_members', '_members.rid = _waresuopinions._members_rid');		$this->db->where(array('_waresuopinions.archive'=>'0', '_wares.archive'=>'0'));		$this->db->orderby('_waresuopinions.createDT DESC');		$this->db->groupby('_waresuopinions.rid');		$this->db->limit('5');		$query = $this->db->get();		if($query->num_rows()) return $query->result_array();		return false;	}	
	public function GetLastReviews(){		$this->db->select("_waresrewievs.*, 							DATE_FORMAT(_waresrewievs.datereview, '%d-%m-%Y | %H:%i') as reviewDATE,							_wares._categories_rid,							_wares._brands_rid,							_wares.slug,							_wares.name as wareNAME");		$this->db->from('_waresrewievs');		$this->db->join('_wares', '_wares.rid = _waresrewievs._wares_rid');		$this->db->join('_pritems', '_wares.rid = _pritems._wares_rid');		$this->db->join('_brands', '_brands.rid = _wares._brands_rid');		$this->db->where(array('_waresrewievs.archive'=>'0', '_wares.archive'=>'0'));		$this->db->orderby('_waresrewievs.datereview DESC');		$this->db->groupby('_waresrewievs.rid');		$this->db->limit('5');		$query = $this->db->get();		if($query->num_rows()) return $query->result_array();		return false;	}
	}